var ie=Object.defineProperty;var ae=(a,e,t)=>e in a?ie(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var f=(a,e,t)=>(ae(a,typeof e!="symbol"?e+"":e,t),t);import M from"https://cdn.jsdelivr.net/npm/chroma-js@2.4.2/+esm";import j from"https://cdn.jsdelivr.net/npm/katex@0.16.10/+esm";import*as _ from"https://cdn.jsdelivr.net/npm/three@0.150.0/build/three.module.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();let l;const Z=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Z.decode();let R=null;function B(){return(R===null||R.byteLength===0)&&(R=new Uint8Array(l.memory.buffer)),R}function N(a,e){return a=a>>>0,Z.decode(B().subarray(a,a+e))}const E=new Array(128).fill(void 0);E.push(void 0,null,!0,!1);let L=E.length;function $(a){L===E.length&&E.push(E.length+1);const e=L;return L=E[e],E[e]=a,e}function ee(a){return E[a]}function se(a){a<132||(E[a]=L,L=a)}function z(a){const e=ee(a);return se(a),e}let T=null;function y(){return(T===null||T.byteLength===0)&&(T=new Int32Array(l.memory.buffer)),T}let I=0;const K=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},re=typeof K.encodeInto=="function"?function(a,e){return K.encodeInto(a,e)}:function(a,e){const t=K.encode(a);return e.set(t),{read:a.length,written:t.length}};function H(a,e,t){if(t===void 0){const r=K.encode(a),c=e(r.length,1)>>>0;return B().subarray(c,c+r.length).set(r),I=r.length,c}let i=a.length,n=e(i,1)>>>0;const s=B();let o=0;for(;o<i;o++){const r=a.charCodeAt(o);if(r>127)break;s[n+o]=r}if(o!==i){o!==0&&(a=a.slice(o)),n=t(n,i,i=o+a.length*3,1)>>>0;const r=B().subarray(n+o,n+i),c=re(a,r);o+=c.written,n=t(n,i,o,1)>>>0}return I=o,n}let A=null;function oe(){return(A===null||A.byteLength===0)&&(A=new Float64Array(l.memory.buffer)),A}const w=Object.freeze({F11Chen2019:0,0:"F11Chen2019",F11KOU2022Average:1,1:"F11KOU2022Average",F11KOU2022Individual:2,2:"F11KOU2022Individual",F11OUR1STA:3,3:"F11OUR1STA",F11OUR1Indiviaul:4,4:"F11OUR1Indiviaul",F11OUR1Average:5,5:"F11OUR1Average",F11OUR2Full:6,6:"F11OUR2Full",F11OUR2Partial:7,7:"F11OUR2Partial",F22KOU2021:8,8:"F22KOU2021",F22KOU2021Withvi:9,9:"F22KOU2021Withvi",F22KOU2021Novi:10,10:"F22KOU2021Novi",F22KOU2023:11,11:"F22KOU2023",F22KOU2023sfb:12,12:"F22KOU2023sfb",F22HU2023:13,13:"F22HU2023",F22OUR1:14,14:"F22OUR1",F22OUR1debug:15,15:"F22OUR1debug"}),G=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>l.__wbg_fenceresult_free(a>>>0));class W{static __wrap(e){e=e>>>0;const t=Object.create(W.prototype);return t.__wbg_ptr=e,G.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,G.unregister(this),e}free(){const e=this.__destroy_into_raw();l.__wbg_fenceresult_free(e)}get tstep(){return l.__wbg_get_fenceresult_tstep(this.__wbg_ptr)}set tstep(e){l.__wbg_set_fenceresult_tstep(this.__wbg_ptr,e)}get tend(){return l.__wbg_get_fenceresult_tend(this.__wbg_ptr)}set tend(e){l.__wbg_set_fenceresult_tend(this.__wbg_ptr,e)}get tcollect(){return l.__wbg_get_fenceresult_tcollect(this.__wbg_ptr)}set tcollect(e){l.__wbg_set_fenceresult_tcollect(this.__wbg_ptr,e)}static new(e){try{const s=l.__wbindgen_add_to_stack_pointer(-16),o=H(e,l.__wbindgen_malloc,l.__wbindgen_realloc),r=I;l.fenceresult_new(s,o,r);var t=y()[s/4+0],i=y()[s/4+1],n=y()[s/4+2];if(n)throw z(i);return W.__wrap(t)}finally{l.__wbindgen_add_to_stack_pointer(16)}}next(){try{const n=l.__wbindgen_add_to_stack_pointer(-16);l.fenceresult_next(n,this.__wbg_ptr);var e=y()[n/4+0],t=y()[n/4+1],i=y()[n/4+2];if(i)throw z(t);return D.__wrap(e)}finally{l.__wbindgen_add_to_stack_pointer(16)}}}const q=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>l.__wbg_timeslice_free(a>>>0));class D{static __wrap(e){e=e>>>0;const t=Object.create(D.prototype);return t.__wbg_ptr=e,q.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,q.unregister(this),e}free(){const e=this.__destroy_into_raw();l.__wbg_timeslice_free(e)}get index(){return l.__wbg_get_timeslice_index(this.__wbg_ptr)>>>0}set index(e){l.__wbg_set_timeslice_index(this.__wbg_ptr,e)}get time(){return l.__wbg_get_timeslice_time(this.__wbg_ptr)}set time(e){l.__wbg_set_timeslice_time(this.__wbg_ptr,e)}get data(){return l.__wbg_get_timeslice_data(this.__wbg_ptr)!==0}set data(e){l.__wbg_set_timeslice_data(this.__wbg_ptr,e)}signals(){let e,t;try{const s=l.__wbindgen_add_to_stack_pointer(-16);l.timeslice_signals(s,this.__wbg_ptr);var i=y()[s/4+0],n=y()[s/4+1];return e=i,t=n,N(i,n)}finally{l.__wbindgen_add_to_stack_pointer(16),l.__wbindgen_free(e,t,1)}}values(){let e,t;try{const s=l.__wbindgen_add_to_stack_pointer(-16);l.timeslice_values(s,this.__wbg_ptr);var i=y()[s/4+0],n=y()[s/4+1];return e=i,t=n,N(i,n)}finally{l.__wbindgen_add_to_stack_pointer(16),l.__wbindgen_free(e,t,1)}}value(e){try{const n=l.__wbindgen_add_to_stack_pointer(-16),s=H(e,l.__wbindgen_malloc,l.__wbindgen_realloc),o=I;l.timeslice_value(n,this.__wbg_ptr,s,o);var t=y()[n/4+0],i=oe()[n/8+1];return t===0?void 0:i}finally{l.__wbindgen_add_to_stack_pointer(16)}}}async function le(a,e){if(typeof Response=="function"&&a instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(a,e)}catch(i){if(a.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const t=await a.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(a,e);return t instanceof WebAssembly.Instance?{instance:t,module:a}:t}}function ce(){const a={};return a.wbg={},a.wbg.__wbindgen_string_new=function(e,t){const i=N(e,t);return $(i)},a.wbg.__wbindgen_object_drop_ref=function(e){z(e)},a.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return $(e)},a.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const i=ee(t).stack,n=H(i,l.__wbindgen_malloc,l.__wbindgen_realloc),s=I;y()[e/4+1]=s,y()[e/4+0]=n},a.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let i,n;try{i=e,n=t,console.error(N(e,t))}finally{l.__wbindgen_free(i,n,1)}},a.wbg.__wbindgen_throw=function(e,t){throw new Error(N(e,t))},a}function de(a,e){return l=a.exports,te.__wbindgen_wasm_module=e,A=null,T=null,R=null,l.__wbindgen_start(),l}async function te(a){if(l!==void 0)return l;typeof a>"u"&&(a=new URL("/mas/assets/fence_bg-7ed6a7d6.wasm",self.location));const e=ce();(typeof a=="string"||typeof Request=="function"&&a instanceof Request||typeof URL=="function"&&a instanceof URL)&&(a=fetch(a));const{instance:t,module:i}=await le(await a,e);return de(t,i)}class J{constructor(e,t){f(this,"type",0);f(this,"is_target",!1);f(this,"x",[]);f(this,"y",[]);this.label=e,this.x=[t[0]],this.y=[t[1]]}add(e){this.x.push(e[0]),this.y.push(e[1])}}class _e{constructor(e,t){f(this,"data",[]);f(this,"time",[]);f(this,"MAX_DATA_LEN",1e3);f(this,"info",{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0});f(this,"min_max_index",0);if(this.time=[e],t.target.length==4||t.target.length==2){let n=new J("target",t.target);n.is_target=!0,this.data.push(n)}const i=t.agents.length;for(let n=0;n<i;n++){const s=t.agents[n].length;(s==4||s==2)&&this.data.push(new J("agent"+(n+1),t.agents[n]))}this.minmax()}get xave(){return(this.info.xmin+this.info.xmax)/2}get yave(){return(this.info.ymin+this.info.ymax)/2}minmax(){for(;this.min_max_index<this.time.length;this.min_max_index++)for(const e of this.data){let t=e.x[this.min_max_index];t<this.info.xmin&&(this.info.xmin=t),t>this.info.xmax&&(this.info.xmax=t);let i=e.y[this.min_max_index];i<this.info.ymin&&(this.info.ymin=i),i>this.info.ymax&&(this.info.ymax=i)}}add(e,t){this.time.push(e);for(const i of this.data)if(i.type==0){let n=[t[`${i.label}_x`],t[`${i.label}_y`]];i.add(n)}this.minmax()}}const C={"chen2019.three_in_a_line_break_failed":{algorithm:w.F11Chen2019,target:[3,10],agents:[[7,10],[3,10],[-1,10]],ode:{tfinal:20,step:.001,tcollect:.1},max_distance:3,min_distance:1,epsilon:.05,delta:10,k:1,max_alpha:1e3,target_u:"(0.,0.)"},"chen2019.three_in_a_line_break":{algorithm:w.F11Chen2019,target:[3,10],agents:[[6.5,10],[3,10],[-1,10]],ode:{tfinal:20,step:.001,tcollect:.1},max_distance:3,min_distance:1,epsilon:.05,delta:10,k:1,max_alpha:1e3,target_u:"(0.,0.)"},"chen2019.moving-target":{algorithm:w.F11Chen2019,target:[3,10],target_u:"rect(3,2,3,2)",agents:[[7,10],[3,10],[-1,10]],ode:{tfinal:20,step:.001,tcollect:.1},max_distance:3,min_distance:1,epsilon:.05,delta:10,k:1,max_alpha:1e3},"kou2022.average":{algorithm:w.F11KOU2022Average,target:[3,10],target_u:"rect(1.6,2,10,4)",agents:[[7,10],[3,10],[-1,10],[-1,4]],ode:{tfinal:20,step:.001,tcollect:.1},max_distance:3,min_distance:1,epsilon:.05,delta:10,k1:1,k2:1,max_alpha:1e3},"kou2022.individual":{algorithm:w.F11KOU2022Individual,target:[3,10],target_u:"rect(1.6,2,10,4)",agents:[[7,10],[3,10],[-1,10],[-1,4]],ode:{tfinal:20,step:.001,tcollect:.1},max_distance:3,min_distance:1,epsilon:.05,delta:10,k1:1,k2:1,max_alpha:1e3},"kou2021.with-velocity-measurement":{algorithm:w.F22KOU2021Withvi,target:[3,10,0,0],target_v:"rect(1.6,2,10,4)",agents:[[7,10,0,0],[3,10,0,0],[-1,10,0,0],[-1,4,0,0]],ode:{tfinal:80,step:.001,tcollect:.1},max_distance:3,min_distance:1,epsilon:.05,delta:10,k1:3,k2:3,k3:1,max_alpha:1e3,detect_target:[1]},"kou2021.without-velocity-measurement":{algorithm:w.F22KOU2021Novi,target:[3,10,0,0],target_v:"rect(1.6,2,10,4)",agents:[[7,10,0,0],[3,10,0,0],[-1,10,0,0],[-1,4,0,0]],ode:{tfinal:80,step:.001,tcollect:.1},max_distance:3,min_distance:1,epsilon:.05,delta:10,k1:3,k2:3,k3:1,max_alpha:100,detect_target:[1]},kou2023:{algorithm:w.F22KOU2023,target:[10,0,0,1],target_u:"(cos(t),sin(t))",agents:[[1,0,0,0],[0,1,0,0],[-1,0,0,0],[0,-1,0,0]],ode:{tfinal:80,step:.001,tcollect:.1},max_distance:3,min_distance:1,epsilon:.05,delta:10,k1:3,k2:3,k3:1,lambda:[2,1.5,1],L:1,max_alpha:1e5},hu2023:{algorithm:w.F22HU2023,target:[2,8,.5,.5],s1:-.1,agents:[[7,7,0,0],[7,-7,0,0],[-7,7,0,0],[-7,-7,0,0]],k:[2.2,6,.1,3,20],max_distance:10,min_distance:2,max_alpha:10,ode:{tfinal:80,step:5e-4,tcollect:.1}},"our2024.moving-target":{algorithm:w.F11OUR2Full,target:[3,10],target_u:"(3.*sin(t),0.)",agents:[[7,10],[3,10],[-1,10]],ode:{tfinal:20,step:.001,tcollect:.1},max_distance:3,min_distance:1,epsilon:.05,delta:10,k:4,max_alpha:1e3},our1_SMC_fully:{algorithm:w.F11OUR2Full,target:[3,10],target_u:"rect(1.2,1.6,10,4)",agents:[[0,4],[4,0],[-4,0],[0,-4],[0,8],[8,0]],detect_target:[1,2],ode:{tfinal:20,step:.002,tcollect:.1},max_distance:5,min_distance:1,distance_1:2,distance_2:3,epsilon:.05,delta:10,k1:2,k2:10,max_alpha:1e3},our1_SMC_partially:{algorithm:w.F11OUR2Partial,target:[3,10],target_u:"rect(1.2,1.6,10,4)",agents:[[0,7],[1,4],[0,0],[-2,0],[1,-3],[-4,7],[-4,4],[-4,-3],[-6,7],[-6,4],[-6,-3]],detect_target:[1,2],ode:{tfinal:20,step:.002,tcollect:.1},max_distance:5,min_distance:1,distance_1:2,distance_2:3,epsilon:.05,delta:10,k1:2,k2:10,max_alpha:1e3}};function he(a){let e=[],t=a.get("name");switch((t==null||!Object.keys(C).includes(t))&&(t="chen2019.three_in_a_line_break"),a.get("id")){case"1":e=["our1_SMC_fully","our1_SMC_partially"],t="our1_SMC_fully";break;case"ADRFGE":e=Object.keys(C);break;default:e=Object.keys(C).filter(i=>!i.startsWith("our")||i==t)}return{keys:e,name:t}}function me(a=256,e=256,t=256){let i=Math.floor(Math.random()*a),n=Math.floor(Math.random()*e),s=Math.floor(Math.random()*t);return console.log("rgb("+i+","+n+","+s+")"),"rgb("+i+","+n+","+s+")"}function S(a,e){const t=Math.log10(Math.abs(a)),i=t>0?Math.floor(t):Math.ceil(t),n=a/Math.pow(10,i);let s=`${n.toFixed(e)}\\times10^{${i}}`;return i==0&&(s=`${n.toFixed(e)}`),i==1&&(s=`${n.toFixed(e)}\\times10`),i==1&&(s=`${a.toFixed(e)}`),s}class ue{constructor(e,t,i){f(this,"params",{d:1,mu:3});f(this,"_params",{d:1,mu:3});f(this,"colors",{});this.eles=e,this.data=t,this.profile=i}dispose(){}render(e){const t=this.eles.canvas;let n=this.data.info,s={x:(n.xmax+n.xmin)/2,y:(n.ymax+n.ymin)/2},o=Math.max(n.xmax-s.x,s.x-n.xmin,n.ymax-s.y,s.y-n.ymin)*2+this.params.d*2,r={x:o,y:o*1};const c="t="+S(e,2);j.render(c,this.eles.span_t,{output:"html"});const g=this.eles.span_right_top,k=s.x+.5*r.x,p=s.y+.5*r.y,x=S(k,2)+","+S(p,2);j.render(x,g,{output:"html"});const m=this.eles.span_left_bottom,b=s.x-.5*r.x,v=s.y-.5*r.y,U=S(b,2)+","+S(v,2);j.render(U,m,{output:"html"});const F=(O,h)=>({x:t.width/2+(O-s.x)*(t.width/r.x),y:t.height/2-(h-s.y)*(t.height/r.y)}),u=t.getContext("2d");if(u){u.clearRect(0,0,t.width,t.height),this._params.d=this.params.d*(.5*t.height)/r.x,this._params.mu=this.params.mu*(.5*t.height)/r.y,u.beginPath(),u.strokeStyle="black",u.moveTo(t.width-1-this._params.mu,t.height-6),u.lineTo(t.width-1,t.height-6),u.stroke(),u.fillStyle="green";const O=3;this.drawCircle(u,t.width-1,t.height-6,O),this.drawCircle(u,t.width-1-this._params.mu,t.height-6,O),this.drawCircle(u,t.width-1-this._params.d,t.height-6,O),this.render_agent(u,F)}}color_gen(e){const t=function(){return typeof M>"u"?me():M.random().hex()},i=this.colors;for(const n of e)i[n]||(i[n]=t());this.colors=i}draw_uav(e,t,i,n){const s=[[1,1],[-1,-1]],o=[[1,-1],[-1,1]],r=this._params.d/2,c=this._params.d-Math.sqrt(2)*r;for(const g of[s,o]){const k=t+g[0][0]*r,p=i+g[0][1]*r,x=t+g[1][0]*r,m=i+g[1][1]*r;e.beginPath(),e.strokeStyle=n,e.moveTo(k,p),e.lineTo(x,m),e.stroke();for(const[b,v]of[[k,p],[x,m]])e.strokeStyle="black",e.fillStyle=n,this.drawCircle(e,b,v,c);e.strokeStyle="gray",this.drawCircle(e,t,i,this._params.d,!1)}}render_agent(e,t){this.color_gen(this.data.data.map(i=>i.label)),this.data.time.length;for(const i of this.data.data){const{x:n,y:s}=t(i.x[i.x.length-1],i.y[i.y.length-1]);i.is_target?(e.strokeStyle="red",this.drawCircle(e,n,s,8,!1)):this.draw_uav(e,n,s,this.colors[i.label]),e.beginPath();let o=t(i.x[0],i.y[0]);e.moveTo(o.x,o.y);for(let r=0;r<this.data.time.length;r++){const{x:c,y:g}=t(i.x[r],i.y[r]);e.lineTo(c,g)}if(typeof M<"u"){let r=M(this.colors[i.label]).brighten(.6).hex();e.strokeStyle=r}e.stroke()}}drawCircle(e,t,i,n,s=!0){e.beginPath(),e.arc(t,i,n,0,2*Math.PI),e.closePath(),s&&e.fill(),e.stroke()}}class fe{constructor(e,t,i){f(this,"scene");f(this,"camera");f(this,"renderer");var U;this.eles=e,this.data=t,this.profile=i;const n=new _.Scene,s=new _.PerspectiveCamera(75,e.canvas.width/e.canvas.height,.1,1e3),o=new _.WebGLRenderer({antialias:!0});o.setPixelRatio(window.devicePixelRatio),o.shadowMap.enabled=!0,o.setSize(e.canvas.width,e.canvas.height),(U=e.canvas.parentElement)==null||U.insertBefore(o.domElement,e.canvas),e.canvas.hidden=!0;let r=new _.Vector3(0,0,0);for(const F of this.data.data)if(F.is_target){const u=new _.BoxGeometry(this.profile.min_distance/2,this.profile.min_distance/2,.1),O=new _.MeshBasicMaterial({color:M("red").hex()}),h=new _.Mesh(u,O);h.position.x=F.x[0],h.position.y=F.y[0],h.position.z=0,r=r.add(h.position),h.name=F.label,n.add(h)}else{const u=new _.CylinderGeometry(this.profile.min_distance/2,this.profile.min_distance/2,.4),O=new _.MeshBasicMaterial({color:M.random().darken(.7).hex()}),h=new _.Mesh(u,O);h.position.x=F.x[0],h.position.y=F.y[0],h.position.z=.1,h.rotation.x=Math.PI/2,r=r.add(h.position),h.name=F.label,n.add(h),h.castShadow=!0}r.divideScalar(this.data.data.length),s.position.x=this.data.xave,s.position.y=this.data.yave,s.position.z=10;const c=new _.SpotLight(16777215);c.position.set(r.x-6,r.y+2,20),c.castShadow=!0,c.shadow.mapSize.width=2048,c.shadow.mapSize.height=2048,n.add(c);const g=new _.PlaneGeometry(100,100),k=new _.MeshStandardMaterial({color:16777215,side:_.DoubleSide}),p=new _.Mesh(g,k);p.name="ground",p.position.z=0,p.position.x=r.x,p.position.y=r.y,p.receiveShadow=!0,n.add(p);const x=400,m=400,b=new _.GridHelper(x,m);b.position.x=0,b.position.y=0,b.rotation.x=Math.PI/2,b.name="grid",n.add(b);const v=new _.AxesHelper;v.position.x=0,v.position.y=0,v.position.z=0,n.add(v),o.render(n,s),this.scene=n,this.camera=s,this.renderer=o}dispose(){this.renderer.domElement.remove(),this.eles.canvas.hidden=!1}render(e){const t=this.data.time.length-1;let i=new _.Vector3,n=0,s=[];this.scene.children.forEach(o=>{o.name.startsWith("ground")&&s.push(o);const r=this.data.data.filter(c=>o.name==c.label);r.length>0&&(o.position.x=r[0].x[t],o.position.y=r[0].y[t],i=i.add(o.position),n++)}),i=i.divideScalar(n),this.camera.position.x=i.x,this.camera.position.y=i.y;for(const o of s)o.position.x=i.x,o.position.y=i.y;this.renderer.render(this.scene,this.camera)}}function V(a){let e=a.values().split(",").map(parseFloat),i=a.signals().split(",").map((s,o)=>[s,e[o]]);return Object.fromEntries(i)}const X=document.getElementsByClassName("simulator")[0],P=document.getElementsByClassName("figure")[0],d={figure:{canvas:P.getElementsByTagName("canvas")[0],span_t:P.getElementsByClassName("t")[0],span_right_top:P.getElementsByClassName("right-top")[0],span_left_bottom:P.getElementsByClassName("left-bottom")[0]},simulator:{simulate:X.getElementsByClassName("simulate")[0],pause_continue:X.getElementsByClassName("pause")[0]},profile_select:document.getElementById("profile-select"),renderer_select:document.getElementById("renderer-select"),profile:document.getElementsByClassName("profile")[0],description:document.getElementsByClassName("description")[0],panel:document.getElementsByClassName("panel")[0]};window.innerHeight>window.innerWidth?(d.figure.canvas.height=window.innerHeight/2,d.figure.canvas.width=window.innerWidth*.9):(d.figure.canvas.height=window.innerHeight*.7,d.figure.canvas.width=window.innerWidth*.8);function Q(a){return new Promise(e=>{setTimeout(e,a*1e3)})}function ne(){let a=d.profile_select.value;d.description.childNodes.forEach(e=>{e.hidden=e.id!==a}),d.panel.innerHTML="";for(const[e,t]of Object.entries(C[a])){const i=document.createElement("label");i.innerText=e;const n=document.createElement("input");switch(n.className="profile_"+a+"_"+e,e=="algorithm"&&n.addEventListener("mouseover",function(){n.title=w[n.value]}),typeof t){case"number":n.type="number",n.value=JSON.stringify(t);break;case"string":n.type="text",n.value=t;break;default:n.type="text",n.value=JSON.stringify(t)}const s=document.createElement("tr"),o=document.createElement("td"),r=document.createElement("td");o.appendChild(i),r.appendChild(n),s.appendChild(o),s.appendChild(r),d.panel.appendChild(s)}}d.profile_select.addEventListener("input",ne);function Y(a,e){const t=structuredClone(a);for(const i in t){const n="profile_"+e+"_"+i,s=d.panel.getElementsByClassName(n)[0];switch(typeof t[i]){case"number":t[i]=parseFloat(s.value);break;case"string":t[i]=s.value;break;case"undefined":break;default:t[i]=JSON.parse(s.value)}}return t}async function ge(){await te();const a=new URL(document.location.toString()),{keys:e,name:t}=he(a.searchParams);e.map(r=>{const c=document.createElement("option");c.value=r,c.innerText=r,d.profile_select.appendChild(c)}),d.profile_select.value=t,ne();let i=0,n,s=d.simulator.pause_continue.innerText=="continue";async function o(){for(;s;)await Q(1)}d.simulator.simulate.addEventListener("click",async function(r){let c=++i;const g=d.profile_select.value,k=Y(C[g],g),p=W.new(JSON.stringify(Y(C[g],g))),x=new _e(0,k);n&&n.dispose(),d.renderer_select.value=="threejs"?n=new fe(d.figure,x,k):n=new ue(d.figure,x,k);let m=p.next(),b=0,v=!1;for(;c==i;)if(m=p.next(),m.data){let U=V(m);x.add(m.time,U),n.render(m.time),await Q(m.time-b),await o(),b=m.time,m.time>10&&!v&&(console.log(x),console.log(V(m)),v=!0)}}),d.simulator.pause_continue.addEventListener("click",function(r){d.simulator.pause_continue.innerText=s?"pause":"continue",s=!s}),d.simulator.simulate.click()}ge();
